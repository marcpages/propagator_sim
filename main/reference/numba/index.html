
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PROPAGATOR: An Operational Cellular-Automata Based Wildfire Simulator">
      
      
      
      
        <link rel="prev" href="../io/">
      
      
        <link rel="next" href="../../bibliography/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Numba Backend - PROPAGATOR Sim</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/cima-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#propagatorcorenumba" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PROPAGATOR Sim" class="md-header__button md-logo" aria-label="PROPAGATOR Sim" data-md-component="logo">
      
  <img src="../../img/cima.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PROPAGATOR Sim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Numba Backend
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PROPAGATOR Sim" class="md-nav__button md-logo" aria-label="PROPAGATOR Sim" data-md-component="logo">
      
  <img src="../../img/cima.png" alt="logo">

    </a>
    PROPAGATOR Sim
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programmatic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programmatic Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Usage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../propagator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I/O
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Numba Backend
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Numba Backend
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#public-facade" class="md-nav__link">
    <span class="md-ellipsis">
      
        Public Facade
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba" class="md-nav__link">
    <span class="md-ellipsis">
      
        numba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.FuelSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        FuelSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FuelSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.FuelSystem.add_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_fuel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.get_p_moisture_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_moisture_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.get_p_time_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_time_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.next_updates_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_updates_fn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fuel-and-model-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fuel and Model Definitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.Fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fuel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.FuelSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        FuelSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FuelSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.FuelSystem.add_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_fuel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probability-and-rate-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Probability and Rate Functions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.clip" class="md-nav__link">
    <span class="md-ellipsis">
      
        clip
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_p_time_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_time_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_p_moisture_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_moisture_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_rothermel" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_rothermel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_wang" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_wang
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_standard" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_standard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.w_h_effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        w_h_effect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.w_h_effect_on_probability" class="md-nav__link">
    <span class="md-ellipsis">
      
        w_h_effect_on_probability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_moisture_trucchia" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_moisture_trucchia
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_moisture_baghino" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_moisture_baghino
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.lhv_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        lhv_fuel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.fireline_intensity" class="md-nav__link">
    <span class="md-ellipsis">
      
        fireline_intensity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_probability_to_neighbour" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_probability_to_neighbour
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagation-kernels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Propagation Kernels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        propagation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="propagation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.fire_spotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        fire_spotting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.compute_spotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_spotting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.calculate_fire_behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_fire_behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.single_cell_updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_cell_updates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.next_updates_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_updates_fn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bibliography/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bibliography
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#public-facade" class="md-nav__link">
    <span class="md-ellipsis">
      
        Public Facade
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba" class="md-nav__link">
    <span class="md-ellipsis">
      
        numba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.FuelSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        FuelSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FuelSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.FuelSystem.add_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_fuel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.get_p_moisture_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_moisture_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.get_p_time_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_time_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.next_updates_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_updates_fn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fuel-and-model-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fuel and Model Definitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.Fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fuel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.FuelSystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        FuelSystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FuelSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.models.FuelSystem.add_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_fuel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#probability-and-rate-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Probability and Rate Functions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.clip" class="md-nav__link">
    <span class="md-ellipsis">
      
        clip
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_p_time_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_time_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_p_moisture_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_p_moisture_fn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_rothermel" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_rothermel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_wang" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_wang
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_time_standard" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_time_standard
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.w_h_effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        w_h_effect
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.w_h_effect_on_probability" class="md-nav__link">
    <span class="md-ellipsis">
      
        w_h_effect_on_probability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_moisture_trucchia" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_moisture_trucchia
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.p_moisture_baghino" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_moisture_baghino
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.lhv_fuel" class="md-nav__link">
    <span class="md-ellipsis">
      
        lhv_fuel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.fireline_intensity" class="md-nav__link">
    <span class="md-ellipsis">
      
        fireline_intensity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.functions.get_probability_to_neighbour" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_probability_to_neighbour
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagation-kernels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Propagation Kernels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        propagation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="propagation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.fire_spotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        fire_spotting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.compute_spotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_spotting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.calculate_fire_behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_fire_behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.single_cell_updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_cell_updates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator.core.numba.propagation.next_updates_fn" class="md-nav__link">
    <span class="md-ellipsis">
      
        next_updates_fn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="propagatorcorenumba">propagator.core.numba</h1>
<p>Numba-accelerated kernels, models, and helper functions backing the simulation
engine. Use these interfaces when you need to customise the low-level spread
behaviour or integrate new stochastic components.</p>
<h2 id="public-facade">Public Facade</h2>


<div class="doc doc-object doc-module">



<h2 id="propagator.core.numba" class="doc doc-heading">
            <code>propagator.core.numba</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="propagator.core.numba.FuelSystem" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">FuelSystem</span><span class="p">(</span><span class="n">n_fuels</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">













  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="propagator.core.numba.FuelSystem.add_fuel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_fuel</span><span class="p">(</span><span class="n">fuel_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">d0</span><span class="p">,</span> <span class="n">hhv</span><span class="p">,</span> <span class="n">d1</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="n">spotting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prob_ign_by_embers</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">burn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adds a Fuel object to the FuelSystem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fuel_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier for the fuel type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fuel type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial spread rate (m/min)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dead fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hhv</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The higher heating value (KJ/kg)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The live fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>humidity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel moisture content (fraction)</p>
              </div>
            </td>
            <td>
                  <code>-9999.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spotting</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is prone to spotting (default is False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prob_ign_by_embers</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of ignition by embers (default is 0.0)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>burn</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is combustible (default is True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.get_p_moisture_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_p_moisture_fn</span><span class="p">(</span><span class="n">moist_model_code</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select a moisture probability correction by code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>moist_model_code</code>
            </td>
            <td>
                  <code><span title="propagator.core.numba.functions.MoistureModel">MoistureModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The code of the moisture model to select.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    function with signature</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(moist: float) -&gt; float</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.get_p_time_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_p_time_fn</span><span class="p">(</span><span class="n">ros_model_code</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select a rate-of-spread model by code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ros_model_code</code>
            </td>
            <td>
                  <code><span title="propagator.core.numba.functions.RateOfSpreadModel">RateOfSpreadModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The code of the rate-of-spread model to select.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    function with signature</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(v0, dem_from, dem_to, angle_to, dist, moist, w_dir, w_speed) -&gt; (time_seconds, ros)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.next_updates_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_updates_fn</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">realizations</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">veg</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">fire</span><span class="p">,</span> <span class="n">moisture</span><span class="p">,</span> <span class="n">wind_dir</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span> <span class="n">fuels</span><span class="p">,</span> <span class="n">p_time_fn</span><span class="p">,</span> <span class="n">p_moist_fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the next updates for the fire spread simulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The row indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>realizations</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The realization indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cellsize</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of each cell (in meters)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current time step.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>veg</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D vegetation array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dem</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D digital elevation model array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fire</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int8">int8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 3D current fire state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D moisture array (units: fraction [0, 1])</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_dir</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind direction array (units: radians between [-π, π], 0 is east-&gt;west)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_speed</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind speed array (units: km/h)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fuels</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FuelSystem(n_fuels) (propagator.core.numba.models.FuelSystem)" href="#propagator.core.numba.models.FuelSystem">FuelSystem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_time_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the spread time (must be jit-compiled). Units are compliant with other functions.
    signature: (v0: float, dh: float, angle_to: float, dist: float, moist: float, w_dir: float, w_speed: float) -&gt; tuple[float, float]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_moist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the moisture probability (must be jit-compiled). Units are compliant with other functions.
    signature: (moist: float) -&gt; float</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="propagator.core.models.UpdateBatchTuple">UpdateBatchTuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the arrays for the next updates.
(next_times, next_rows, next_cols, next_realizations, next_ros, next_fireline_intensities)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="fuel-and-model-definitions">Fuel and Model Definitions</h2>


<div class="doc doc-object doc-module">



<h2 id="propagator.core.numba.models" class="doc doc-heading">
            <code>propagator.core.numba.models</code>


</h2>

    <div class="doc doc-contents first">

        <p>Models and data structures for the Numba JIT-compiled wildfire propagation engine.</p>
<p>This file defines the data structures used in the Numba JIT-compiled wildfire propagation engine.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="propagator.core.numba.models.Fuel" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Fuel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">d0</span><span class="p">,</span> <span class="n">hhv</span><span class="p">,</span> <span class="n">d1</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="n">spotting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prob_ign_by_embers</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">burn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



        <p>Initialize a Fuel object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fuel type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial spread rate (m/min)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dead fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hhv</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The higher heating value (KJ/kg)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The live fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>humidity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel moisture content (fraction)</p>
              </div>
            </td>
            <td>
                  <code>-9999.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spotting</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is prone to spotting (default is False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prob_ign_by_embers</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of ignition by embers (default is 0.0)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>burn</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is combustible (default is True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="propagator.core.numba.models.FuelSystem" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">FuelSystem</span><span class="p">(</span><span class="n">n_fuels</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">













  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="propagator.core.numba.models.FuelSystem.add_fuel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_fuel</span><span class="p">(</span><span class="n">fuel_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">d0</span><span class="p">,</span> <span class="n">hhv</span><span class="p">,</span> <span class="n">d1</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="n">spotting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prob_ign_by_embers</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">burn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adds a Fuel object to the FuelSystem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fuel_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier for the fuel type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the fuel type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial spread rate (m/min)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dead fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hhv</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The higher heating value (KJ/kg)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The live fuel density (kg/m^2)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>humidity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel moisture content (fraction)</p>
              </div>
            </td>
            <td>
                  <code>-9999.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spotting</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is prone to spotting (default is False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prob_ign_by_embers</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of ignition by embers (default is 0.0)</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>burn</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the fuel type is combustible (default is True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="probability-and-rate-functions">Probability and Rate Functions</h2>


<div class="doc doc-object doc-module">



<h2 id="propagator.core.numba.functions" class="doc doc-heading">
            <code>propagator.core.numba.functions</code>


</h2>

    <div class="doc doc-contents first">

        <p>Spread, probability, and intensity model functions.</p>
<p>This module contains pluggable formulations for rate-of-spread, probability
modulators for wind/slope/moisture, fire spotting distance, and fireline
intensity utilities used by the core propagator.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.clip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Clip x to the range [min, max].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clipped value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.get_p_time_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_p_time_fn</span><span class="p">(</span><span class="n">ros_model_code</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select a rate-of-spread model by code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ros_model_code</code>
            </td>
            <td>
                  <code><span title="propagator.core.numba.functions.RateOfSpreadModel">RateOfSpreadModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The code of the rate-of-spread model to select.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    function with signature</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(v0, dem_from, dem_to, angle_to, dist, moist, w_dir, w_speed) -&gt; (time_seconds, ros)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.get_p_moisture_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_p_moisture_fn</span><span class="p">(</span><span class="n">moist_model_code</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select a moisture probability correction by code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>moist_model_code</code>
            </td>
            <td>
                  <code><span title="propagator.core.numba.functions.MoistureModel">MoistureModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The code of the moisture model to select.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    function with signature</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>(moist: float) -&gt; float</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.p_time_rothermel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_time_rothermel</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">moist</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Propagation time and ROS according to Rothermel-like scaling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base Rate of Spread for the cell vegetation (m/min)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Elevation difference between source and neighbor cells. (m)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction to neighbor (clockwise radians, 0 is north -&gt; south)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance between cells (m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture values (fraction).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(transition time [s], ROS [m/min]).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.p_time_wang" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_time_wang</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">moist</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Propagation time and ROS according to Wang et al.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base ROS vector per vegetation type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Elevation at source and neighbor cells.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction to neighbor (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance to neighbour cell (m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture values (fractional).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(transition time [s], ROS [m/min]).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.p_time_standard" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_time_standard</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">moist</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Baseline propagation time and ROS with combined wind-slope factor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base ROS vector per vegetation type.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Elevation difference between source and neighbor cells.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction to neighbor (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance to neighbor (m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture values (%).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(transition time [s], ROS [m/min]).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.w_h_effect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">w_h_effect</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scale factor taking into account wind, slope and aspect effects on propagation rate of spread.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle to the neighboring pixel (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elevation difference between source and neighbor cells (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to the neighbor (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scale factor for wind, slope, and aspect effects on propagation rate of spread.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.w_h_effect_on_probability" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">w_h_effect_on_probability</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scale factor taking into account wind, slope and aspect effects on probability.
This is derived from <code>w_h_effect</code> by scaling the output non linearly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle to the neighboring pixel (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elevation difference between source and neighbor cells (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to the neighbor (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scale factor for wind, slope, and aspect effects on probability.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.p_moisture_trucchia" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_moisture_trucchia</span><span class="p">(</span><span class="n">moist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Moisture correction to the transition probability p_{i,j}.</p>
<p>Uses a 5th-degree polynomial in x = moist/Mx, with Mx = 0.3
(Trucchia et al., Fire 2020).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>moist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture content (fractional).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture correction factor (p_{i,j}).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.p_moisture_baghino" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_moisture_baghino</span><span class="p">(</span><span class="n">moist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Moisture correction to p_{i,j}.
Older formulation, Baghino; Trucchia et al., 2020).
Parameters come from constants.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>moist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture content (fractional).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Moisture correction factor (p_{i,j}).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.lhv_fuel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lhv_fuel</span><span class="p">(</span><span class="n">hhv</span><span class="p">,</span> <span class="n">moisture</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Lower heating value of fuels given higher
heating value and FFMC.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hhv</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Higher heating value of dead fuel (kJ/kg).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fuel moisture content (fractional).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.fireline_intensity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fireline_intensity</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">ros</span><span class="p">,</span> <span class="n">lhv_dead_fuel</span><span class="p">,</span> <span class="n">lhv_canopy</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Estimate fireline intensity (kW/m) from fuel loads and Rate of spread.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dead fuel density (kg/m^2).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d1</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Canopy fuel density (kg/m^2).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ros</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rate of spread (m/min).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lhv_dead_fuel</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower heating value of dead fuel (kJ/kg).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lhv_canopy</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower heating value of canopy fuel (kJ/kg).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fireline intensity (kW/m).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.functions.get_probability_to_neighbour" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_probability_to_neighbour</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">,</span> <span class="n">moisture</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">transition_probability</span><span class="p">,</span> <span class="n">p_moist_fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the probability of fire spread to a neighboring pixel.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle to the neighboring pixel (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to the neighboring pixel (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The moisture content (fraction).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The difference in height (meters).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transition_probability</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base transition probability.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_moist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the moisture probability (must be jit-compiled). Units are compliant with other functions.
    signature: (moist: float) -&gt; float</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The probability of fire spread to the neighboring pixel.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="propagation-kernels">Propagation Kernels</h2>


<div class="doc doc-object doc-module">



<h2 id="propagator.core.numba.propagation" class="doc doc-heading">
            <code>propagator.core.numba.propagation</code>


</h2>

    <div class="doc doc-contents first">

        <p>Propagation functions for fire spread simulation.</p>
<p>This module contains functions for simulating fire spread in a grid environment,
including ember spotting and cell updates.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.propagation.fire_spotting" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fire_spotting</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate spotting distance using Alexandridis' formulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle of the ember's trajectory (clockwise radians, 0 is north -&gt; south)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spotting distance (meters) and the landing time (seconds)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.propagation.compute_spotting" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_spotting</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">,</span> <span class="n">veg</span><span class="p">,</span> <span class="n">fire</span><span class="p">,</span> <span class="n">wind_dir</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span> <span class="n">fuels</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute ember spotting updates for a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>row</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The row index of the current cell</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column index of the current cell</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cellsize</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of each cell (m)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>veg</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vegetation type array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fire</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int8">int8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fire state array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fuels</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FuelSystem(n_fuels) (propagator.core.numba.models.FuelSystem)" href="#propagator.core.numba.models.FuelSystem">FuelSystem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel system object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of spotting updates, each represented as a tuple
(transition_times, rows, cols, rates_of_spread, fireline_intensities)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.propagation.calculate_fire_behavior" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_fire_behavior</span><span class="p">(</span><span class="n">fuel_from</span><span class="p">,</span> <span class="n">fuel_to</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">moisture</span><span class="p">,</span> <span class="n">w_dir</span><span class="p">,</span> <span class="n">w_speed</span><span class="p">,</span> <span class="n">p_time_fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate fire behaviour during propagation between cells</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fuel_from</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Fuel(name, v0, d0, hhv, d1=0.0, humidity=-9999.0, spotting=False, prob_ign_by_embers=0.0, burn=True) (propagator.core.numba.models.Fuel)" href="#propagator.core.numba.models.Fuel">Fuel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel object for the source cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fuel_to</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Fuel(name, v0, d0, hhv, d1=0.0, humidity=-9999.0, spotting=False, prob_ign_by_embers=0.0, burn=True) (propagator.core.numba.models.Fuel)" href="#propagator.core.numba.models.Fuel">Fuel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel object for the target cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dh</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elevation difference between the source and target cells (m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dist</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to the target cell (m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The angle to the target cell (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The moisture content of the fuel (fraction).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_dir</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind direction (clockwise radians, 0 is north -&gt; south).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w_speed</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wind speed (km/h).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_time_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the spread time (must be jit-compiled). Units are compliant with other functions.
    signature: (v0: float, dh: float, angle_to: float, dist: float, moist: float, w_dir: float, w_speed: float) -&gt; tuple[float, float]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the transition time, rate of spread, and fireline intensity.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.propagation.single_cell_updates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">single_cell_updates</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">,</span> <span class="n">veg</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">fire</span><span class="p">,</span> <span class="n">moisture</span><span class="p">,</span> <span class="n">wind_dir</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span> <span class="n">fuels</span><span class="p">,</span> <span class="n">p_time_fn</span><span class="p">,</span> <span class="n">p_moist_fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply fire spread to a single cell and get the next spread updates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>row</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The row index of the current cell</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column index of the current cell</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cellsize</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of each cell (in meters)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>veg</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D vegetation array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dem</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D digital elevation model array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fire</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int8">int8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D current fire state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D moisture array (units: fraction [0, 1])</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_dir</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind direction array (units: radians between [-π, π], 0 is east-&gt;west)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_speed</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind speed array (units: km/h)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fuels</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FuelSystem(n_fuels) (propagator.core.numba.models.FuelSystem)" href="#propagator.core.numba.models.FuelSystem">FuelSystem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_time_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the spread time (must be jit-compiled). Units are compliant with other functions.
    signature: (v0: float, dh: float, angle_to: float, dist: float, moist: float, w_dir: float, w_speed: float) -&gt; tuple[float, float]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_moist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the moisture probability (must be jit-compiled). Units are compliant with other functions.
    signature: (moist: float) -&gt; float</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of fire spread updates (transition_times, rows, cols, rates_of_spread, fireline_intensities)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="propagator.core.numba.propagation.next_updates_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_updates_fn</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">realizations</span><span class="p">,</span> <span class="n">cellsize</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">veg</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">fire</span><span class="p">,</span> <span class="n">moisture</span><span class="p">,</span> <span class="n">wind_dir</span><span class="p">,</span> <span class="n">wind_speed</span><span class="p">,</span> <span class="n">fuels</span><span class="p">,</span> <span class="n">p_time_fn</span><span class="p">,</span> <span class="n">p_moist_fn</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the next updates for the fire spread simulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The row indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>realizations</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The realization indices of the fire spread updates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cellsize</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of each cell (in meters)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current time step.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>veg</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D vegetation array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dem</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D digital elevation model array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fire</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int8">int8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 3D current fire state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moisture</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D moisture array (units: fraction [0, 1])</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_dir</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind direction array (units: radians between [-π, π], 0 is east-&gt;west)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wind_speed</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.floating">floating</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 2D wind speed array (units: km/h)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fuels</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FuelSystem(n_fuels) (propagator.core.numba.models.FuelSystem)" href="#propagator.core.numba.models.FuelSystem">FuelSystem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fuel system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_time_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the spread time (must be jit-compiled). Units are compliant with other functions.
    signature: (v0: float, dh: float, angle_to: float, dist: float, moist: float, w_dir: float, w_speed: float) -&gt; tuple[float, float]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_moist_fn</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to compute the moisture probability (must be jit-compiled). Units are compliant with other functions.
    signature: (moist: float) -&gt; float</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="propagator.core.models.UpdateBatchTuple">UpdateBatchTuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the arrays for the next updates.
(next_times, next_rows, next_cols, next_realizations, next_ros, next_fireline_intensities)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.indexes", "navigation.instant", "content.code.copy", "toc.follow"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../javascripts/cima-brand.js"></script>
      
    
  </body>
</html>